version: 2

models:
  - name: stg_stades
    description: "Table de staging des stades, nettoyée et typée."
    columns:
      - name: stade_id
        description: "Identifiant unique du stade."
        tests:
          - unique    # Échouera avec votre doublon ID 3
          - not_null  # Échouera avec votre ID à NULL

      - name: pays_nom
        description: "Nom du pays en majuscules."
        tests:
          - accepted_values:
              values: [
                "ALLEMAGNE", "MEXIQUE", "UKRAINE", "GRÈCE", 
                "ITALIE", "PORTUGAL", "ÉCOSSE", "SUISSE", 
                "FRANCE", "MAROC", "TURQUIE", "PAYS-BAS", 
                "BELGIQUE", "ANGLETERRE", "ESPAGNE", "AUTRICHE"
              ]

      - name: stade_nom
        tests:
          - not_null

      - name: capacite_stade
        description: "Capacité totale du stade."
        tests:
          - not_null
          # "CHECK" (Capacité positive)
          - dbt_utils.accepted_range:
              min_value: 0
              inclusive: true # Doit échouer si vous avez inséré -500